# 🌍 惑星探索システム WBS（Work Breakdown Structure）

## Phase 1: 基盤構築（Week 1）

### 1.1 プロジェクト準備（Day 1）
- [ ] フォルダ構造の作成
  - [ ] `planetExploration/` ディレクトリ作成 ✅
  - [ ] サブディレクトリ作成（terrain/, physics/, utils/）
  - [ ] 基本的なファイルテンプレート作成
- [ ] 設計書の最終確認とチーム共有
- [ ] 開発環境の準備
  - [ ] 必要なnpmパッケージの確認
  - [ ] TypeScript設定の更新

### 1.2 モード切り替えシステム（Day 2）
- [ ] `GameMode` enumの実装
- [ ] `PlanetExplorationManager.ts` の基本実装
  - [ ] `enterPlanetExploration()` メソッド
  - [ ] `exitPlanetExploration()` メソッド
  - [ ] シーン切り替えロジック
- [ ] GameStateの拡張
  - [ ] `planetExploration` プロパティ追加
  - [ ] 状態管理の統合

### 1.3 惑星表面生成（Day 3-4）
- [ ] `PlanetSurface.ts` の実装
  - [ ] 基本的な球体ジオメトリ生成
  - [ ] マテリアルシステム
  - [ ] シンプルなテクスチャ適用
- [ ] `TerrainGenerator.ts` の基本実装
  - [ ] Perlinノイズによる高さマップ生成
  - [ ] 頂点変形アルゴリズム
  - [ ] 法線の再計算

### 1.4 プレイヤー制御（Day 5-6）
- [ ] `PlayerController.ts` の実装
  - [ ] 基本的な移動入力処理（WASD）
  - [ ] 球面上の移動計算
  - [ ] 重力による球面投影
- [ ] `SphericalMovement.ts` の実装
  - [ ] 接平面での移動計算
  - [ ] 座標系変換
  - [ ] 移動速度の調整

### 1.5 カメラ制御（Day 7）
- [ ] `CameraController.ts` の実装
  - [ ] サードパーソンビューの基本実装
  - [ ] マウスによる視点回転
  - [ ] カメラの追従処理
  - [ ] 地形との衝突回避

## Phase 2: 基本機能実装（Week 2）

### 2.1 UI実装（Day 8-9）
- [ ] `PlanetExplorationUI.ts` の実装
  - [ ] 探索モード専用UIの作成
  - [ ] 「宇宙に戻る」ボタン
  - [ ] 座標表示
  - [ ] FPS/デバッグ情報表示
- [ ] UIの表示/非表示切り替え
- [ ] 既存UIとの統合

### 2.2 資源システム（Day 10-11）
- [ ] `ResourceNode.ts` の実装
  - [ ] 資源ノードの基本クラス
  - [ ] 惑星表面への配置ロジック
  - [ ] 視覚的表現（光る鉱石など）
- [ ] 資源の種類定義
  - [ ] 通常資源（塵、金属など）
  - [ ] レア資源の設定

### 2.3 採取メカニクス（Day 12）
- [ ] プレイヤーと資源の距離判定
- [ ] 採取アクション（Eキー）の実装
- [ ] 採取アニメーション（簡易版）
- [ ] インベントリへの追加処理

### 2.4 ミニマップ（Day 13）
- [ ] 2D投影マップの生成
- [ ] プレイヤー位置の表示
- [ ] 発見した資源の表示
- [ ] 探索済みエリアの記録

### 2.5 セーブ/ロード対応（Day 14）
- [ ] 探索状態の保存
  - [ ] プレイヤー位置
  - [ ] 発見した資源
  - [ ] インベントリ
- [ ] セーブデータからの復元
- [ ] 既存セーブシステムとの統合

## Phase 3: 建築システム（Week 3）

### 3.1 建造物基盤（Day 15-16）
- [ ] `Structure.ts` 基底クラスの実装
- [ ] 建造物の種類定義
  - [ ] 採掘施設
  - [ ] 貯蔵庫
  - [ ] 観測所
- [ ] 3Dモデルの準備（簡易版）

### 3.2 建設メカニクス（Day 17-18）
- [ ] 建設モードの実装（Bキー）
- [ ] 建設可能位置の判定
  - [ ] 地形の平坦度チェック
  - [ ] 他の建造物との干渉チェック
- [ ] 建設プレビュー表示
- [ ] 資源消費処理

### 3.3 建造物の機能（Day 19-20）
- [ ] `MiningFacility.ts` の実装
  - [ ] 自動資源採取
  - [ ] 効率計算
  - [ ] アップグレードシステム（基礎）
- [ ] 建造物の更新処理
- [ ] 生産物の宇宙視点への反映

### 3.4 建設UI（Day 21）
- [ ] 建設メニューの実装
- [ ] 建造物リスト表示
- [ ] 必要資源の表示
- [ ] 建設進捗バー

## Phase 4: 統合とポリッシュ（Week 4）

### 4.1 宇宙視点との統合（Day 22-23）
- [ ] 惑星クリック時の「探索」ボタン追加
- [ ] モード切り替えのスムーズな遷移
  - [ ] カメラのズームイン演出
  - [ ] フェードエフェクト
- [ ] 探索可能惑星の条件設定

### 4.2 パフォーマンス最適化（Day 24-25）
- [ ] 視界カリングの実装
- [ ] LODシステムの基本実装
- [ ] メモリ使用量の最適化
- [ ] FPS測定と改善

### 4.3 バグ修正とテスト（Day 26-27）
- [ ] 既知のバグ修正
- [ ] エッジケースのテスト
  - [ ] 小さい惑星での移動
  - [ ] 極地での移動
- [ ] セーブ/ロードの安定性テスト

### 4.4 ドキュメント整備（Day 28）
- [ ] コード内コメントの追加
- [ ] APIドキュメントの作成
- [ ] 操作マニュアルの作成
- [ ] 今後の拡張案のまとめ

## 工数見積もり

| フェーズ | 期間 | 主要成果物 |
|---------|------|-----------|
| Phase 1 | 7日 | 惑星を歩き回れる基本システム |
| Phase 2 | 7日 | 資源採取とUI |
| Phase 3 | 7日 | 建築システム |
| Phase 4 | 7日 | 統合と品質向上 |

**合計: 28日（4週間）**

## リスクと対策

### 技術的リスク
1. **球面上の移動が不自然**
   - 対策：既存の球面移動ライブラリの調査
   - 代替案：固定カメラアングルでの実装

2. **パフォーマンス問題**
   - 対策：早期からのプロファイリング
   - 代替案：地形の詳細度を下げる

3. **既存システムとの競合**
   - 対策：慎重な統合テスト
   - 代替案：独立したシステムとして実装

### スケジュールリスク
1. **予想以上の実装難易度**
   - 対策：Phase 2以降は優先順位をつけて実装
   - 代替案：建築システムを次回アップデートに延期

## 完了基準

### Phase 1完了基準
- [ ] 惑星表面を歩き回れる
- [ ] カメラが適切に追従する
- [ ] 宇宙視点との切り替えができる

### Phase 2完了基準
- [ ] 資源を発見・採取できる
- [ ] UIが正しく表示される
- [ ] セーブ/ロードが機能する

### Phase 3完了基準
- [ ] 建造物を建設できる
- [ ] 建造物が機能する（資源生成など）
- [ ] 建設UIが使いやすい

### Phase 4完了基準
- [ ] 60FPSで安定動作する
- [ ] 重大なバグがない
- [ ] ドキュメントが完備されている

## 成功指標

1. **技術的成功**
   - スムーズな球面移動
   - 安定したパフォーマンス
   - シームレスなモード切り替え

2. **ゲームプレイ的成功**
   - 探索が楽しい
   - 資源採取に意味がある
   - 建築に戦略性がある

3. **ビジネス的成功**
   - プレイ時間の増加
   - 課金ポイントの創出
   - プレイヤーの定着率向上